# week 4

## 스프링 시큐리티와 스프링 시큐리티 Oauth2 클라이언트 
* 스프링부트 2 방식인 Spring Security Oauth2 Client 라이브러리를 사용해서 진행  
* 스프링부트 1.5 방식과의 차이 
    * 1.5는 url 주소 모두 명시해야함
    * 2.0 은 client 인증 정보만 입력하면 됨 

## 구글 서비스 등록 
* 구글 클라우드 플랫폼에서 oauth2 클라이언트 id를 생성하고 설정해주었다. 자세한 내용은 소스코드를 참고. 

## 구글 로그인 연동하기 
* User 클래스를 그대로 사용하면 안되는 이유: 세션에 저장하기 위해 User 클래스를 세션에 저장하려고 할 때, User 클래스에 `직렬화를 구현`하지 않아서 에러가 발새안다. 
    * User 클래스가 엔티티이기 때문에 언제 다른 엔티티와 관계가 형성될지 모르므로 섣불리 직렬화 코드를 넣으면 안됨! -> 성능 이슈, 부수 효과 발생 가능 
    * 따라서 **직렬화 기능을 가진 세션 Dto**를 하나 추가로 만드는 것이 이후 운영 및 유지보수 때 많은 도움이 됨 

## 어노테이션 기반으로 개선하기 
* 메소드 인자로 세션값을 바로 받도록 변경 

## 세션 저장소로 데이터베이스 사용하기 
* 설정이 간단하고 사용자가 많은 서비스가 아니며 비용 절감을 위해 선택. 

## 기존 테스트에 시큐리티 적용하기
* 아무리 해도 test 가 가 다 정상적으로 실행되지는 않습니다.
* 3개의 테스트만 제대로 돌아가는 상황을 확인했습니다. 